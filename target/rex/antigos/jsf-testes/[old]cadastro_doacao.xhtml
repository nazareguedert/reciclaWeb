<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	<h:head>
	  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	  
		<title>Cadastro Doação</title>
	

		
	</h:head>
	
	<h:body class="background">
	
		<div class="container full-width col s12 m12 l12">
			<fieldset class="row">
						<legend>Cadastro de Doação</legend>
	
				<h:form id="teste" action="index.xhtml?faces-redirect=true">
					<ul id="tabs-swipe-demo" class="tabs background">
						<li class="tab col s6 m6 l6"><a class="active" href="#tab-endereco">Endereço</a></li>
						<li class="tab col s6 m6 l6"><a href="#tab-material">Material</a></li>
					</ul>

					<div id="tab-endereco" class="container full-width col s12 m12 l12">
								<fieldset class="row">
								
									<legend>Dados Gerais:</legend>
									
									
									<div class="col s12 m12 l12 row">
									
									<div class="input-field col s12 m7 l3">
										<h:selectOneMenu id="pais" value="#{cadastroDoacaoController.doacao.endereco.bairro.municipio.estado.pais}" 
										converter="paisConverter" valueChangeListener="#{cadastroDoacaoController.defineEstados}">
										
											<f:selectItem itemLabel="#{'Selecione'}" />
											<f:selectItems value="#{cadastroDoacaoController.paises}"
												var="item" itemValue="#{item}" itemLabel="#{item.nome}"  />
											<f:ajax event="change" render="estado" />
										</h:selectOneMenu>
											<label for="pais">País</label>
									</div>
									


									<div class="input-field col s12 m5 l3">
										<h:inputText id="cep" name="cep" type="text" class="validate" required="required"
										value="#{cadastroDoacaoController.doacao.endereco.cep}"	maxlength="9" onkeypress="return mascaraGenerica(event, this, '#####-###');">
											<f:ajax event="change" />
										</h:inputText>
											<label for="cep">CEP</label>
									</div>
	
									<div class="input-field col s12 m12 l6">
										<h:selectOneMenu id="estado" value="#{cadastroDoacaoController.doacao.endereco.bairro.municipio.estado}"
										converter="estadoConverter">
											<f:selectItem itemValue="#{cadastroDoacaoController.doacao.endereco.bairro.municipio.estado}" itemLabel="#{'Selecione'}" />
											<f:selectItems value="#{cadastroDoacaoController.estados}"
												var="item" itemValue="#{item}" itemLabel="#{item.nome}" />
											<f:ajax listener="#{cadastroDoacaoController.defineMunicipios}" event="change" />
										</h:selectOneMenu>
											<label for="estado">Estado</label>
									</div>
									
									
									</div>
									
									<div class="col s12 m12 l12 row">
									
									<div class="input-field col s12 m6 l6">
										<h:selectOneMenu id="municipio" value="#{cadastroDoacaoController.doacao.endereco.bairro.municipio}"
										converter="municipioConverter" required="true">
											<f:selectItem itemValue="#{cadastroDoacaoController.doacao.endereco.bairro.municipio}" itemLabel="#{'Selecione'}" noSelectionOption="true" />
											<f:selectItems value="#{cadastroDoacaoController.municipios}"
												var="item" itemValue="#{item}" itemLabel="#{item.nome}" />
											<f:ajax listener="#{cadastroDoacaoController.defineBairros}" event="change" />
										</h:selectOneMenu>
											<label for="municipio">Município</label>
									</div>
									
									<div class="input-field col s12 m6 l6">
										<h:selectOneMenu id="bairro" value="#{cadastroDoacaoController.doacao.endereco.bairro}"
										converter="bairroConverter">
											<f:selectItem itemValue="#{cadastroDoacaoController.doacao.endereco.bairro}" itemLabel="#{'Selecione'}" />
											<f:selectItems value="#{cadastroDoacaoController.bairros}"
												var="item" itemValue="#{item}" itemLabel="#{item.nome}" />
											<f:ajax event="change" />
										</h:selectOneMenu>
											<label for="bairro">Bairro</label>
									</div>
									</div>
									
									<div class="col s12 m12 l12 row">
									<div class="input-field col s12 m5 l4">
										<h:selectOneMenu id="tipo-logradouro" value="#{cadastroDoacaoController.doacao.endereco.logradouro.tipoLogradouro}"
										converter="tipoLogradouroConverter">
											<f:selectItem itemValue="#{cadastroDoacaoController.doacao.endereco.logradouro.tipoLogradouro}" itemLabel="#{'Selecione'}" />
											<f:selectItems value="#{cadastroDoacaoController.tiposLogradouro}"
												var="item" itemValue="#{item}" itemLabel="#{item.nome}" />
											<f:ajax event="change" />
										</h:selectOneMenu>
											<label for="tipo-logradouro">Tipo Logradouro</label>
									</div>
									
									<div class="input-field col s12 m7 l8">
										<h:inputText id="nome_logradouro" name="nome_logradouro" type="text" class="validate" required="required"
										value="#{cadastroDoacaoController.doacao.endereco.logradouro.nome}"	
										maxlength="50">
											<f:ajax event="change" />
										</h:inputText>
											<label for="nome_logradouro">Logradouro</label>
									</div>
									
									</div>
									
									
									<div class="input-field col s12 m9 l9">
										<h:inputText id="complemento" name="complemento" type="text" class="validate" required="required"
										value="#{cadastroDoacaoController.doacao.endereco.complemento}"	
										maxlength="50">
											<f:ajax event="change" />
										</h:inputText>
											<label for="complemento">Complemento</label>
									</div>
									
									<div class="input-field col s12 m3 l3">										
										<h:inputText id="numero_endereco" name="numero_endereco" type="text" class="validate" required="required"
										value="#{cadastroDoacaoController.doacao.endereco.numero}"	
										maxlength="5" onkeypress="return mascaraGenerica(event, this, '#####');">
											<f:ajax event="change" />
										</h:inputText>
											<label for="numero_endereco">Número</label>
									</div>
									
									<div class="input-field col s12 m6 l6">

							            
							            <h:selectOneMenu id="pais2" value="#{dropdownView.country}" style="width:150px">
							                <f:ajax listener="#{dropdownView.onCountryChange}" render="cidade2" />
							                <f:selectItem itemLabel="Selecione" itemValue="" noSelectionOption="true" />
							                <f:selectItems value="#{dropdownView.countries}" />
							            </h:selectOneMenu>
							            <label for="pais2">País</label>

									</div>
									<div class="input-field col s12 m6 l6">
						            
						            <h:selectOneMenu id="cidade2" value="#{dropdownView.city}" style="width:150px">
						                <f:selectItem itemLabel="Selecione" itemValue="" noSelectionOption="true" />
						                <f:selectItems value="#{dropdownView.cities}" />
						            </h:selectOneMenu>
						            <label for="cidade2">Cidade</label>

									</div>
									
								</fieldset>
					</div>
					<div id="tab-material" class="container full-width col s12 m12 l12">
								<fieldset class="row">
								
									<legend>Dados dos Materiais:</legend>
									
										<div class="input-field col s12 m6 l6">
											<h:inputText id="titulo" name="titulo" type="text" class="validate" required="required"
											value="#{cadastroDoacaoController.doacao.titulo}" maxlength="25">
												<f:ajax event="change" />
											</h:inputText>
												<label for="titulo">Título</label>
										</div>
										<div class="input-field col s12 m6 l6">
											<h:inputText id="descricao" name="descricao" type="text" class="validate" required="required"
											value="#{cadastroDoacaoController.doacao.descricao}" maxlength="25">
												<f:ajax event="change" />
											</h:inputText>
												<label for="titulo">Descrição</label>
										</div>
																			
										<fieldset class="row col s12 m12 l12">
											<legend>Incluir Materiais:</legend>
												
												
													<div class="input-field col s12 m6 l5">
														<f:ajax event="action" immediate="true">						
														<h:selectOneMenu id="tipo_material" name="tipo_material" value="#{cadastroDoacaoController.materialIncluir.material}"
														converter="materialConverter">
															<f:selectItem itemValue="#{cadastroDoacaoController.materialIncluir.material}" itemLabel="#{'Selecione'}" />
															<f:selectItems value="#{cadastroDoacaoController.tiposMateriais}"
																var="item" itemValue="#{item}" itemLabel="#{item.nome}" />
															<f:ajax event="change" />
														</h:selectOneMenu>
														</f:ajax>
															<label for="tipo_material">Tipo do Material</label>
													</div>
													
													<div class="input-field col s9 m3 l5">
														<h:inputText id="qtd_material" name="qtd_material" type="text" class="validate" required="required"
														value="#{cadastroDoacaoController.materialIncluir.quantia}"	
														maxlength="3" onkeypress="return mascaraGenerica(event, this, '###');">
															<f:ajax event="change" />
														</h:inputText>
															<label for="qtd_material">Quantia</label>
													</div>
													
													<div class="input-field col s3 m2 l1">
														<h:commandButton class="btn gray white-text" value="+" actionListener="#{cadastroDoacaoController.incluirMaterial()}">
															<f:ajax event="action" render="qtd_material tabelaMateriais" />
														</h:commandButton>
													</div>
												
												
										</fieldset>
										
										<fieldset class="row col s12 m12 l12">
											<legend>Relação de Materiais:</legend>
												
													<div class="input-field col s12 m12 l12">

														<h:dataTable id="tabelaMateriais" class="striped highlight" 
														value="#{cadastroDoacaoController.doacao.materiais}" var="item">
															<h:column>
																<f:facet name="header">Material</f:facet>    				
																#{item.material.nome}
															</h:column>
																										
															<h:column>
																<f:facet name="header">Quantidade</f:facet>    				
																#{item.quantia}
															</h:column>
															
															<h:column>
																<f:facet name="header">Apagar</f:facet>    				
																<h:commandButton value="X" immediate="true" class="btn waves-effect red white-text"
																actionListener="#{cadastroDoacaoController.excluirMaterial(cadastroDoacaoController.doacao.materiais.indexOf(item))}">
																	<f:ajax event="action" render="tabelaMateriais" resetValues="true" listener="#{cadastroDoacaoController.recarregar}" />
																</h:commandButton>
															</h:column>										
															
														</h:dataTable>

													</div>
												
										</fieldset>
									
								</fieldset>
					
					</div>
					
			
						<div class="col s12 m12 l12 center">
								<h:commandButton class="btn waves-effect blue white-text" 
								actionListener="#{cadastroDoacaoController.salvarDoacao()}" value="Salvar">
									<f:ajax event="action" listener="#{cadastroDoacaoController.recarregar}" />
								</h:commandButton>
								<h:commandButton class="btn waves-effect red white-text" value="Limpar" 
								actionListener="#{cadastroDoacaoController.construir()}">
									<f:ajax event="action" listener="#{cadastroDoacaoController.recarregar}" />
								</h:commandButton>
								<h:commandButton class="btn waves-effect blue-grey white-text" value="Início" 
								actionListener="#{indexController.setCentro('landing_page.xhtml')}">
									<f:ajax event="action" listener="#{cadastroDoacaoController.recarregar}" />
								</h:commandButton>
			
						</div>
				</h:form>
			</fieldset>
			</div>		

	</h:body>

</html>